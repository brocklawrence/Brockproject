<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dodge the Red Emoji Game - Levels</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../styles/resume-style.css">
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
        <a class="navbar-brand" href="../brocksresume.html">Resume</a>
        <a class="navbar-brand" href="hobby.html">Hobby</a>
        <a class="navbar-brand" href="#">Game</a>
    </div>
</nav>

  <style>
    
    body {
      font-family: Arial, sans-serif;
      background-color: #f0f2f5;
      margin: 0;
      padding: 0;
    }
    #game-container {
      position: relative;
      width: 700px;
      height: 450px;
      margin: 50px auto;
      border: 2px solid #333;
      border-radius: 10px;
      background-color: #fff;
      overflow: hidden;
    }
    #player, #chaser, #door {
      position: absolute;
      font-size: 30px;
      cursor: default;
      z-index: 2;
      transition: left 0.05s linear, top 0.05s linear;
    }
    #player { left: 50px; top: 50px; }
    #chaser { left: 600px; top: 350px; }
    #door { left: 650px; top: 50px; font-size: 40px; }
    .obstacle {
      position: absolute;
      background-color: #555;
      z-index: 1;
      border-radius: 5px;
    }
    #scoreboard, #levelDisplay {
      text-align: center;
      font-size: 20px;
      margin-top: 10px;
    }
    #restartBtn { display: block; margin: 10px auto; }
    #startMessage {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 50px;
      font-weight: bold;
      color: green;
      z-index: 5;
      display: none;
    }
  </style>
</head>
<body>
<div class="container text-center">
  <h1>Run from the FIRE!ðŸ”¥</h1>
  <p>Use arrow keys to move your emoji. Avoid the red emoji and reach the door to advance levels! Try to make it to level 10!</p>

  <div id="game-container">
    <div id="player">ðŸ˜€</div>
    <div id="chaser">ðŸ”¥</div>
    <div id="door">ðŸšª</div>
    <div id="startMessage">START!</div>
  </div>

  <div id="levelDisplay">Level: 1</div>
  <div id="scoreboard">Time survived: 0 seconds</div>
  <button id="restartBtn" class="btn btn-primary">Restart Game</button>
</div>

<script>
const player = document.getElementById('player');
const chaser = document.getElementById('chaser');
const door = document.getElementById('door');
const gameContainer = document.getElementById('game-container');
const scoreboard = document.getElementById('scoreboard');
const restartBtn = document.getElementById('restartBtn');
const levelDisplay = document.getElementById('levelDisplay');
const startMessage = document.getElementById('startMessage');

let playerPos = { x: 50, y: 50 };
let chaserPos = { x: 600, y: 350 };
let playerSpeed = 3;
let baseChaserSpeed = 3;
let chaserSpeed = baseChaserSpeed;
let score = 0;
let running = false;
let level = 1;
let obstacles = [];
let gameInterval, scoreInterval;
let keys = {};
let canPlayerMove = false; 
let canChaserMove = false;

document.addEventListener('keydown', e => {
  if (canPlayerMove) keys[e.key] = true;
});
document.addEventListener('keyup', e => {
  if (canPlayerMove) keys[e.key] = false;
});

function checkCollision(rect1, rect2) {
  return !(
    rect1.x > rect2.x + rect2.width ||
    rect1.x + rect1.width < rect2.x ||
    rect1.y > rect2.y + rect2.height ||
    rect1.y + rect1.height < rect2.y
  );
}

function canMove(x, y) {
  const rect = { x, y, width: 30, height: 30 };
  for (const obs of obstacles) {
    const obsRect = { x: obs.offsetLeft, y: obs.offsetTop, width: obs.offsetWidth, height: obs.offsetHeight };
    if (checkCollision(rect, obsRect)) return false;
  }
  return true;
}

function createObstacles(level) {
  obstacles.forEach(o => o.remove());
  obstacles = [];
  const maxAttempts = 100;

  for (let i = 0; i < level + 2; i++) {
    let obs, attempts = 0;
    while (attempts < maxAttempts) {
      const width = 50 + Math.random() * 100;
      const height = 20 + Math.random() * 80;
      const top = Math.random() * (gameContainer.clientHeight - height);
      const left = Math.random() * (gameContainer.clientWidth - width);

      const obsRect = { x: left, y: top, width, height };
      const playerRect = { x: playerPos.x, y: playerPos.y, width: 30, height: 30 };
      const chaserRect = { x: chaserPos.x, y: chaserPos.y, width: 30, height: 30 };
      const doorRect = { x: door.offsetLeft, y: door.offsetTop, width: 40, height: 40 };

      if (!checkCollision(obsRect, playerRect) && !checkCollision(obsRect, chaserRect) && !checkCollision(obsRect, doorRect)) {
        obs = document.createElement('div');
        obs.className = 'obstacle';
        obs.style.width = `${width}px`;
        obs.style.height = `${height}px`;
        obs.style.top = `${top}px`;
        obs.style.left = `${left}px`;
        gameContainer.appendChild(obs);
        obstacles.push(obs);
        break;
      }
      attempts++;
    }
  }
}
document.addEventListener('keydown', e => {
  if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(e.key)) {
    e.preventDefault(); // stops page from scrolling
  }
  if (canPlayerMove) keys[e.key] = true;
});
function updatePlayer() {
  if (running && canPlayerMove) {
    let newX = playerPos.x;
    let newY = playerPos.y;

    if (keys['ArrowUp']) newY -= playerSpeed;
    if (keys['ArrowDown']) newY += playerSpeed;
    if (keys['ArrowLeft']) newX -= playerSpeed;
    if (keys['ArrowRight']) newX += playerSpeed;

    if (newX >= 0 && newX <= gameContainer.clientWidth - 30 &&
        newY >= 0 && newY <= gameContainer.clientHeight - 30 &&
        canMove(newX, newY)) {
      playerPos.x = newX;
      playerPos.y = newY;
      player.style.left = playerPos.x + 'px';
      player.style.top = playerPos.y + 'px';
    }

    const doorRect = { x: door.offsetLeft, y: door.offsetTop, width: 40, height: 40 };
    const playerRect = { x: playerPos.x, y: playerPos.y, width: 30, height: 30 };
    if (checkCollision(playerRect, doorRect)) {
      advanceLevel();
    }
  }
  requestAnimationFrame(updatePlayer);
}

function moveChaser() {
  if (!running || !canChaserMove) return;

  let dx = playerPos.x - chaserPos.x;
  let dy = playerPos.y - chaserPos.y;
  let dist = Math.sqrt(dx*dx + dy*dy);
  let stepX = (dx/dist) * chaserSpeed;
  let stepY = (dy/dist) * chaserSpeed;

  let newX = chaserPos.x + stepX;
  let newY = chaserPos.y + stepY;

  if (!canMove(newX, newY)) {
    const alternatives = [
      { x: chaserPos.x + stepX, y: chaserPos.y },
      { x: chaserPos.x, y: chaserPos.y + stepY },
      { x: chaserPos.x - stepX, y: chaserPos.y },
      { x: chaserPos.x, y: chaserPos.y - stepY }
    ];
    for (const alt of alternatives) {
      if (canMove(alt.x, alt.y)) {
        newX = alt.x;
        newY = alt.y;
        break;
      }
    }
  }

  chaserPos.x = newX;
  chaserPos.y = newY;
  chaser.style.left = chaserPos.x + 'px';
  chaser.style.top = chaserPos.y + 'px';

  const playerRect = { x: playerPos.x, y: playerPos.y, width: 10, height: 10 };
const chaserRect = { x: chaserPos.x, y: chaserPos.y, width: 10, height: 10 };

if (checkCollision(playerRect, chaserRect)) {
    loseGame();
}
}

function updateScore() {
  if (running) {
    score++;
    scoreboard.textContent = `Time survived: ${score} seconds`;
  }
}

function startGame() {
  running = true;
  score = 0;
  keys = {};
  canPlayerMove = false;
  canChaserMove = false;

  playerPos = { x: 50, y: 50 };
  chaserPos = { x: 600, y: 350 };
  player.style.left = playerPos.x + 'px';
  player.style.top = playerPos.y + 'px';
  chaser.style.left = chaserPos.x + 'px';
  chaser.style.top = chaserPos.y + 'px';

  chaserSpeed = baseChaserSpeed + (level - 1) * 0.5;
  levelDisplay.textContent = `Level: ${level}`;
  createObstacles(level);

  clearInterval(gameInterval);
  clearInterval(scoreInterval);

  gameInterval = setInterval(moveChaser, 20);
  scoreInterval = setInterval(updateScore, 1000);

  // Show "START!" message and start movement after 1 second
  startMessage.style.display = 'block';
  setTimeout(() => {
    startMessage.style.display = 'none';
    canPlayerMove = true;
    canChaserMove = true;
  }, 1000);
}

function advanceLevel() {
  if (level >= 10) {
    alert(`You won the game! ðŸŽ‰ Total time survived: ${score} seconds`);
    level = 1;
  } else {
    level++;
  }
  startGame();
}

function loseGame() {
  alert(`Caught by the chaser! You reached level ${level} and survived ${score} seconds.`);
  level = 1;
  startGame();
}

restartBtn.addEventListener('click', () => {
  level = 1;
  startGame();
});

updatePlayer();
startGame();
</script>
</body>
</html>
